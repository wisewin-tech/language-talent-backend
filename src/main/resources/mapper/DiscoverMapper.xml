<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 【管理员】 -->
<mapper namespace="com.wisewin.backend.dao.DiscoverDAO">


    <select id="countDiscover" parameterType="java.util.Map" resultType="java.lang.Integer">
        SELECT COUNT(1) FROM lt_discover
        <where>
            <if test="type != '' and type != null">
                `type`   LIKE  CONCAT('%',#{type},'%')
            </if>
            <if test="createTime != '' and createTime != null">
                AND create_time LIKE  CONCAT('%',#{createTime},'%')
            </if>
            <if test="title != '' and title != null">
                AND title LIKE  CONCAT('%',#{title},'%')
            </if>
            and  `show` =  #{yes}
        </where>
        <!-- WHERE `type` LIKE   AND dc_releasetime LIKE 	AND title  LIKE-->

    </select>

    <select id="queryListDiscoverBO" parameterType="java.util.Map" resultType="com.wisewin.backend.entity.bo.DiscoverBO">
  SELECT id, title, browse, dc_name as dcName, create_time as createTime, dc_updatename as dcUpdatename,
        update_time as updateTime, thumbnail, video, content, `type`,
    likenum, participation, activitytime, activitysite, phone, ticket, priority, stick, `show`, skip,way
	FROM
	language_talent.lt_discover

            <where>
                <if test="type != '' and type != null">
                    `type`   LIKE  CONCAT('%',#{type},'%')
                </if>
                <if test="create_time != '' and createTime != null">
                    AND dc_releasetime LIKE  CONCAT('%',#{createTime},'%')
                </if>
                <if test="title != '' and title != null">
                    AND title LIKE  CONCAT('%',#{title},'%')
                </if>
                and  `show` =  #{yes}
        </where>
	ORDER  BY  stick  DESC
        <include refid="limit" />
    </select>

    <sql id="limit">
        limit #{pageOffset},#{pageSize}
    </sql>



    <update id="updateDiscoverbyShows" parameterType="Integer[]" >

    UPDATE language_talent.lt_discover
        SET
        `show` = 'no'
         where id in
            <foreach item="item" collection="array" open="(" separator="," close=")">
                #{item}
            </foreach>
        </update>

    <update id="updateDiscoverbySticks"  >

        UPDATE language_talent.lt_discover
        SET

        <if test="stick != null and stick != ''">
            `stick` =  #{stick}
        </if>

        where id in
        <foreach item="item" collection="idArr" open="(" separator="," close=")">
            #{item}
        </foreach>
    </update>

    <update id="updateDiscoverbyStick" parameterType="java.lang.String">
    UPDATE language_talent.lt_discover
        SET
        stick = 'yes'

        WHERE
        id = #{discoverId} ;
    </update>


    <update id="updateDiscoverbyShow" parameterType="java.lang.String">
        UPDATE language_talent.lt_discover
        SET
        `show` = 'no'

        WHERE
        id = #{id} ;
    </update>

    <update id="updateDiscover" parameterType="com.wisewin.backend.entity.bo.DiscoverBO">
        UPDATE language_talent.lt_discover
            SET
            title = #{title} ,
            browse = #{browse} ,
            dc_updatename = #{dcUpdatename} ,
            update_time = #{updateTime},
            thumbnail = #{thumbnail} ,
            video = #{video} ,
            content = #{content} ,
            `type` = #{type} ,
            likenum = #{likenum} ,
            participation = #{participation} ,
            activitytime = #{activitytime} ,
            activitysite = #{activitysite} ,
            phone = #{phone} ,
            ticket = #{ticket} ,
            priority = #{priority} ,
            stick = #{stick} ,
            `show` = #{show} ,
            skip = #{skip} ,
            way =  #{way}
            WHERE
            id = #{id} ;
    </update>

    <select id="queryDiscoverBO" resultType="com.wisewin.backend.entity.bo.DiscoverBO" parameterType="java.lang.String">
         SELECT id, title, browse, dc_name as dcName, create_time as createTime, dc_updatename as dcUpdatename,
       update_time as updateTime, thumbnail, video, content, `type`,
        likenum, participation, activitytime, activitysite, phone, ticket, priority, stick, `show`, skip
        FROM
        language_talent.lt_discover where id = #{id}
    </select>
</mapper>